<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="XpressFormula"
           Manufacturer="Digixoil"
           Version="$(var.ProductVersion)"
           UpgradeCode="{F4DE7D79-8A62-4A32-986B-0F5EAF77B0F7}"
           InstallerVersion="500"
           Scope="perMachine"
           Language="1033">
    <MajorUpgrade DowngradeErrorMessage="A newer version of XpressFormula is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Icon Id="AppIcon" SourceFile="$(var.AppIconPath)" />
    <Property Id="ARPPRODUCTICON" Value="AppIcon" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="XpressFormula">
        <Component Id="MainExecutableComponent" Guid="*">
          <File Id="MainExecutableFile"
                Source="$(var.AppExePath)"
                Name="XpressFormula.exe"
                KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="StartMenuFolder" Name="XpressFormula">
        <Component Id="StartMenuComponent" Guid="*">
          <Shortcut Id="StartMenuShortcut"
                    Name="XpressFormula"
                    Description="XpressFormula Mathematical Plotter"
                    Target="[INSTALLFOLDER]XpressFormula.exe"
                    WorkingDirectory="INSTALLFOLDER"
                    Icon="AppIcon" />
          <RemoveFolder Id="RemoveStartMenuFolder" On="uninstall" />
          <RegistryValue Root="HKCU"
                         Key="Software\Digixoil\XpressFormula"
                         Name="Installed"
                         Type="integer"
                         Value="1"
                         KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <Feature Id="MainFeature" Title="XpressFormula" Level="1">
      <ComponentRef Id="MainExecutableComponent" />
      <ComponentRef Id="StartMenuComponent" />
    </Feature>
  </Package>
</Wix>
